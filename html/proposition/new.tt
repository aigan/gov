[% META title = 'Create new propositions'
        next_action = 'make_proposition'
        next_template = 'display.tt'
%]

[%
   types   = C.proposition.revlist('scof');
   areas   = u.has_voting_jurisdiction;
   methods = C.resolution_method.revlist('is');
%]

<h1>[% aloc(title) %]</h1>


[% IF u.level == 0 %]
  [% aloc('You must be logged in to create a proposition.') %]
[% ELSIF areas.size == 0 %]
  [% aloc('You must have jurisdiction in an area to create a proposition.') %]
[% ELSIF types.size == 0 %]
  [% aloc('There are no proposition types available.') %]
[% ELSE %]

  <table>
    <tr>
      <td><label for="name">[% aloc('Title of proposition') %]</label></td>
      <td>[% input('name', '', id='name') %]</td>
    </tr>
    <tr>
      <td><label for="area">[% aloc('Area') %]</label></td>
      <td>
        [% IF areas.size == 1 %]
          [% area = areas.get_first_nos %]
          [% hidden('area', area.id) %]
          ${area.desig}
        [% ELSE %]
          [% selector('area','',areas.sorted,
	               header=loc('Select'),
                       valkey='id',
                       tagkey='desig') %]
        [% END %]
      </td>
    </tr>
    <tr>
      <td><label for="type">[% aloc('Type') %]</label></td>
      <td>
        [% IF types.size == 1 %]
          [% type = types.get_first_nos %]
          [% hidden('type', type.id) %]
          ${type.desig}
        [% ELSE %]
          [% selector('type','',types.sorted,
	               header=loc('Select'),
                       valkey='id',
                       tagkey='desig') %]
        [% END %]
      </td>
    </tr>
    <tr>
      <td><label for="method">[% aloc('Resolution method') %]</label></td>
      <td>
        [% IF methods.size == 1 %]
          [% method = methods.get_first_nos %]
          [% hidden('method', method.id) %]
          ${method.desig}
        [% ELSE %]
          [% selector('method','',methods.sorted,
	               header=loc('Select'),
                       valkey='id',
                       tagkey='desig') %]
        [% END %]
      </td>
    </tr>
    <tr>
      <td valign="top">
        <label for="discussion_url">[% aloc('Discussion url') %]</label><br/>
        
      </td>
      <td>
[% input('discussion_url', '', id='discussion_url') %]<br/>
[% alocpp('discussion_url') %]

</td>
    </tr>
    <tr>
      <td colspan="2"><label for="text">[% aloc('Text') %]</label><br/>
      [% textarea('text', '', id='text', class="html_editable") %]</td>
    </tr>
    <tr><td/><td>[% submit(locn('Save')) %]</td></tr>
  </table>
[% END %]

